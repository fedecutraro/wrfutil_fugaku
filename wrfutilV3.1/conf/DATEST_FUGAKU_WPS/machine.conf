#!/bin/bash 

#### CLUSTER ###
export MACHINE='FUGAKUPPS'                                        # Options HYDRA, FUGAKU , FUGAKUPPS
export ICORE=5                                                 # Cantidad de Cores por Nodos del cluster
export INODE=1                                                  # Cantidad de Maxima de nodos solicitados
export QUEUESYS='PJM'                                             # Sistema de colas [SLURM | PBS | PBSPRO | SGE | PBS_block | SSH | PJM ]
export QUEUE='larga'                                              # LA cola en la que hay que encolar
export QEXCLU=0                                                 # 1=La reserva de nodos en exlusiva, es decir hay que utilizar todos los cores
export QSUB_ROOT=""

source ${BASEDIR}/lib/encolar${QUEUESYS}.sh                     # Selecciona el metodo de encolado segun el systema QUEUESYS elegido



##############
# Paralelizacion
##############
export LETKFPROC=48                                                     # Cantidad de procesos  para el LETKF
export LETKFTHREAD=1                                                   # Cantidad de threads por porcesos del LETKF
export LETKFNODE=1                                                     # Cantidad de nodos para el LETKF
export LETKFWALLTIME="03:00:00"                                         # Tiempo estimado en HH:MM:SS que el proceso durara como maximo

export OBSPROC=1                                                        # Cantidad de procesos  para el LETKF
export OBSTHREAD=1                                                     # Cantidad de threads por porcesos del LETKF
export OBSWALLTIME="03:00:00"                                           # Tiempo estimado en HH:MM:SS que el proceso durara como maximo

export RADOBSPROC=1                                                     # Cantidad de procesos  para el LETKF
export RADOBSTHREAD=1                                                  # Cantidad de threads por porcesos del LETKF
export RADOBSWALLTIME="03:00:00"                                        # Tiempo estimado en HH:MM:SS que el proceso durara como maximo

export WPSNODE=1
export WPSPROC=1                                                        # Cantidad de nodos para el WPS
export WPSTHREAD=1                                                     # Cantidad de threads  por proceso GEOGRID/METGRID
export WPSWALLTIME="03:00:00"                                           # Tiempo estimado en HH:MM:SS que el proceso durara como maximo

export PERTNODE=1
export PERTPROC=48                                                      # Cantidad de procesos  para la perturbacion del met_em
export PERTTHREAD=48                                                   # Cantidad de threads usados en la perturbacion del met_em
export PERTWALLTIME="03:00:00"                                          # Tiempo estimado en HH:MM:SS que el proceso durara como maximo

export WRFNODE=1                                                        # Cantidad de nodos para el WRF
export WRFPROC=6                                                       # Cantidad de procesos por nodo para el WRF
export WRFTHREAD=1                                                      # Cantidad de threads por proceso del WRF
export WRFWALLTIME="03:00:00"                                           # Tiempo estimado en HH:MM:SS que el proceso durara como maximo
export WRF_RUNTIME_FLAGS="NONE"                                         # Run time flags for wrf

#Specify machine dependent enviroment settings
if [ $MACHINE = "FUGAKU"  ] ; then

  export LD_LIBRARY_PATH=/lib64:/usr/lib64:/opt/FJSVxtclanga/tcsds-latest/lib64:/opt/FJSVxtclanga/tcsds-latest/lib/:/vol0004/ra000007/data/jruiz/comp_libs_fujitsu/netcdf/lib:$LD_LIBRARY_PATH
  export I_MPI_SPAWN=on
  export MPIEXEC=mpiexec

elif [ $MACHINE = "FUGAKUPPS" ] ; then

  . /opt/intel/oneapi/setvars.sh intel64
  export PATH=\$PATH:/home/ra000007/a04037/anaconda3/bin
  export LD_LIBRARY_PATH=/home/ra000007/a04037/data/comp_libs/grib2/lib/:/home/ra000007/a04037/data/comp_libs/netcdf/lib/:$LD_LIBRARY_PATH
  export I_MPI_SPAWN=on
  set FI_TCP_IFACE=lo
  export MPIEXEC=mpiexec

elif [ $MACHINE = "HYDRA" ] ; then

  source /opt/load-libs.sh 1
  export PATH=/opt/intel/oneapi/intelpython/latest/bin/:$PATH
  source activate letkf_wrf
  export LD_LIBRARY_PATH=/home/jruiz/salidas/libpng-1.2.50/lib/:$LD_LIBRARY_PATH
  export HDF5_USE_FILE_LOCKING=FALSE
  export MPIEXEC=mpiexec

fi

